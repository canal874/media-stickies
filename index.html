<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script>
// See https://github.com/electron/electron/issues/254
if (typeof module === "object" && module.exports) {
  window.$ = window.jQuery = module.exports;
  module.exports = {};
}

const sprite = { id: "" };

$(() => {
  let main = require("electron").remote.require("./main");
  const ipcRenderer = require( 'electron' ).ipcRenderer;

  //----------------------
  // Initialize sprite
  //----------------------
  ipcRenderer.on('sprite-loaded', (event, id, cdata) => {
    sprite.id = id;
    Object.freeze(sprite);
    $('#contents').html(cdata);
  });

  //--------------------------
  // Save and close sprite
  //--------------------------
  ipcRenderer.on('sprite-saved-to-close', (event) => {
    window.close();
  });
  $('#closeBtn').click(() => {
    var data = $('#contents').val();
    var json = {
      key: sprite.id,
      cdata: data
    };
    main.saveToCloseSprite(sprite.id, json);
  });
});
</script>
</head>
<body>
<!-- 
-webkig-app-region:drag を設定した子要素は、マウスイベントを取得できないので注意 
-->
<div style="top:0px; left:0px; width:226px; height:16px; background-color:#d0d090; position:absolute; -webkit-app-region:drag; padding:0px; margin:0px;"></div>
<div id="closeBtn" style="background-color:#d0d090; position:absolute; top:0px; right:0px; border:1px solid black; width:14px; height:14px; text-align:center; font-size:16px; padding:0px;font-family:sans-serif;cursor:pointer">X</div>
<textarea id="contents" style="top:16px; left:0px; width:240px; height:160px; background-color:#f0f0a0; position:absolute; padding:0px; margin:0px;border:0px;">
</textarea>

</body>
</html>